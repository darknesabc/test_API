<!DOCTYPE html>
<html lang="ko">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Attendance</title>
    <script src="https://code.jquery.com/jquery-3.6.0.min.js"></script>
</head>
<body>
    <h1>출결 데이터</h1>
    <button id="loadData">데이터 불러오기</button>
    <table id="attendanceTable" border="1">
        <thead>
            <tr>
                <th>이름</th>
                <th>자리번호</th>
                <th>날짜</th>
                <!-- 추가적인 열을 여기에 정의 -->
            </tr>
        </thead>
        <tbody>
            <!-- 데이터가 여기에 삽입됩니다 -->
        </tbody>
    </table>

    <script>
        const apiKey = 'AIzaSyDeS-WjQLmzG7yw1_GWu5Tw3HwFxG5hYbk'; // API 키
        const sheetId = '1cTEkCLZyYN1c9qzo2YLHI06ZbCu8_qf42q2CaKyRoo0'; // 시트 ID
        const range = '출결!A1:U43'; // 데이터 범위

        // Google Sheets API에서 데이터 불러오기
        function loadSheetData() {
            const url = `https://sheets.googleapis.com/v4/spreadsheets/${sheetId}/values/${range}?key=${apiKey}`;
            $.get(url, function(data) {
                const rows = data.values;
                const tbody = $('#attendanceTable tbody');
                tbody.empty(); // 기존 데이터 지우기

                if (rows && rows.length > 0) {
                    rows.forEach((row, index) => {
                        if (index === 0) return; // 첫 행은 헤더이므로 건너뛰기
                        const tr = $('<tr>');
                        row.forEach(cell => {
                            tr.append($('<td>').text(cell));
                        });
                        tbody.append(tr);
                    });
                } else {
                    tbody.append($('<tr><td colspan="3">데이터 없음</td></tr>'));
                }
            }).fail(function() {
                alert('데이터를 불러오는 데 실패했습니다.');
            });
        }

        // 버튼 클릭 시 데이터 불러오기
        $(document).ready(function() {
            $('#loadData').click(loadSheetData);
        });
    </script>
</body>
</html>
