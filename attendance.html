<!DOCTYPE html>
<html lang="ko">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Attendance Tracker</title>
    <script src="https://apis.google.com/js/api.js"></script>
    <script>
        const API_KEY = 'AIzaSyDeS-WjQLmzG7yw1_GWu5Tw3HwFxG5hYbk'; // API 키
        const SHEET_ID = '1cTEkCLZyYN1c9qzo2YLHI06ZbCu8_qf42q2CaKyRoo0'; // 수정된 시트 ID
        const RANGE = '출결!A1:U43'; // 가져올 데이터 범위

        function initApi() {
            gapi.load('client', () => {
                gapi.client.init({
                    'apiKey': API_KEY,
                }).then(() => {
                    return gapi.client.sheets.spreadsheets.values.get({
                        spreadsheetId: SHEET_ID,
                        range: RANGE,
                    });
                }).then((response) => {
                    const data = response.result.values;
                    displayData(data);
                }, (error) => {
                    console.error('Error fetching data: ', error);
                });
            });
        }

        function displayData(data) {
            const output = document.getElementById('output');
            output.innerHTML = '';
            if (data && data.length > 0) {
                data.forEach((row) => {
                    const rowElement = document.createElement('div');
                    rowElement.textContent = row.join(', ');
                    output.appendChild(rowElement);
                });
            } else {
                output.textContent = '데이터가 없습니다.';
            }
        }

        window.onload = initApi;
    </script>
</head>
<body>
    <h1>Attendance Data</h1>
    <div id="output"></div>
</body>
</html>
