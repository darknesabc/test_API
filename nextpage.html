<!DOCTYPE html>
<html lang="ko">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>환영합니다!</title>
    <style>
        /* 기존 스타일 유지 */
    </style>
</head>
<body>
    <header>
        <div id="userInfo">
            <div id="userName"></div>
            <button id="logoutButton">로그아웃</button>
        </div>
    </header>

    <nav class="menu">
        <a href="#" id="attendanceStatus">출결 현황</a>
        <a href="#">성적</a>
        <a href="#">교육 점수</a>
        <a href="#">기타</a>
    </nav>

    <main>
        <h1>환영합니다!</h1>
        <p>성공적으로 로그인되었습니다.</p>
    </main>

    <script>
        // 첫 로그인 페이지에서 저장된 자리번호와 사용자 이름 불러오기
        const userName = localStorage.getItem('username'); // 자리번호와 이름이 함께 저장됨

        if (userName) {
            document.getElementById('userName').innerText = userName; // 자리번호와 사용자 이름 표시
        } else {
            document.getElementById('userName').innerText = '사용자'; // 이름이 없을 경우 기본값
        }

        // 출결 현황 클릭 이벤트
        document.getElementById('attendanceStatus').addEventListener('click', function() {
            const seatNumber = userName.split(' ')[0]; // 자리번호 가져오기
            const today = new Date().toISOString().slice(0, 10); // 오늘 날짜 가져오기
            const sheetId = '1cTEkCLZyYN1c9qzo2YLHI06ZbCu8_qf42q2CaKyRoo0'; // 시트 ID
            const apiKey = 'AIzaSyDeS-WjQLmzG7yw1_GWu5Tw3HwFxG5hYbk'; // API 키
            const url = `https://sheets.googleapis.com/v4/spreadsheets/${sheetId}/values/출결!A:C?key=${apiKey}`; // 출결 시트 URL

            fetch(url)
                .then(response => response.json())
                .then(data => {
                    const rows = data.values;
                    let attendance = '출결 데이터가 없습니다.'; // 기본 메시지 설정

                    if (rows) {
                        for (let i = 0; i < rows.length; i++) {
                            if (rows[i][0] === seatNumber && rows[i][1] === today) { // 자리번호와 오늘 날짜 비교
                                attendance = rows[i][2]; // 출결 상태 저장
                                break;
                            }
                        }
                    }
                    alert(`오늘의 출결 현황: ${attendance}`); // 출결 상태 알림
                })
                .catch(error => console.error('Error fetching data:', error));
        });

        // 로그아웃 버튼 동작 설정
        document.getElementById('logoutButton').addEventListener('click', function() {
            localStorage.clear(); // 로그아웃 시 localStorage에서 사용자 정보 삭제
            alert('로그아웃되었습니다.');
            window.location.href = 'index.html'; // 로그인 페이지로 돌아가기
        });
    </script>
</body>
</html>
